# CVE重現詳情

## 工作內容
1. [尋找新的CVE](#尋找新的CVE)
2. [重建受害環境](#重建受害環境)
3. [Exploit](#exploit)
4. [紀錄步驟](#紀錄步驟)
5. back to step 1.

### 尋找新的CVE
我找的是以RCE為主，建議以以下條件進行搜尋：
1. CVSSv3 >= 7.0
2. 常用的、影響力大的產品(eg. Tomcat, Ghostscript, Drupal, Exim, Ruby, Supervisord, Ruby on Rails...)
3. 網路上有PoC、Exploit script
4. 網路上有Snort/Suricata rule(若之後開始研發rule，則此條件會被拔除)  
rule的主要來源為Snort官方提供的，例如[CVE-2020-0674](https://www.snort.org/rule_docs/1-54400)，以分類**BROWSER-IE**在[snortrules-snapshot](https://www.snort.org/downloads#rules)(我是載2983跟29170)可以找到對應檔案，在檔案中搜尋**2020-0674**即可找到rule  
另外有這種的[CVE-2020-17121](https://blog.snort.org/2020/12/snort-rule-update-for-dec-8-2020.html)，找到SID(SID 56554)後，直接用SID去google搜尋，即可找到[跟上一個一樣的網站](https://www.snort.org/rule_docs/1-56554)

附上已經搜尋完成的CVE：
* [CVEdetails](https://www.cvedetails.com/top-50-products.php)(2020後沒再更新)
    1. Debian Linux 2019
    2. Debian Linux 2018
    3. Debian Linux 2017
* [OpenCVE](https://www.opencve.io/cve)(以關鍵字搜尋)
    1. 2021
    2. 2020

### 重建受害環境
建環境比較看個人造化，其中比較重要的是要**善用VM拍snapshot的功能**，每當重建到一個段落、不確定下一步是否會出錯、或是重建完成時，最好都拍個(不拍白不拍)，否則想要重現之前的情境又要重頭架，第二次架搞不好又遇到不一樣的問題

### Exploit
沒甚麼特別的，就是用找CVE時找到的PoC、github上的Exploit script、Kali上的metasploit攻擊，頂多有時候想拿到shell的時候要加入reverse shell(很多PoC都只帶到執行指令)

### 紀錄步驟
將試驗完成的VM拍個snapshot，或是再開一個VM，然後從頭開始重架一遍，並且邊架邊記錄步驟
